<!doctype html>
<html>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Avail Rest test tool</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <!--li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li role="separator" class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li-->
          </ul>
          <ul class="nav navbar-nav navbar-right">
            
            <li class="active"><form class="form-inline">
      <div class="form-group" style="padding-top: 10px">
            <label for="exampleInputName2">Date range</label>
    <input class="form-control" type="text" name="daterange"  />

        <label for="exampleInputName2">Env</label>
        <select id="selector" class="form-control"> 
                <option title="localhost">localhost</option>
                <option title="10.163.76.95">grsdevlab95.hiw.com</option>
                <option title="10.163.76.156">grsdevlab156.hiw.com</option>
                <option title="10.163.76.45">grsdevlab45.hiw.com</option>
                <option title="10.163.24.64">adcavailabilityi1.hiw.com</option>

              </select>
      </div>
     
    </form></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>


  <head>
    <title>Hotel Rest test cases</title>
    <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1/jquery.min.js"></script>
    <script type="text/javascript" src="http://fgnass.github.com/spin.js/spin.js"></script>

  <script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <!-- Include Date Range Picker -->
  <script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
  <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
  <script type="text/javascript">
    $(function() {
      
    });
  </script>
  </head>
   
    
    <div class="container">
     <h4>Hotel Rest</h4>
     
  <br>
     <div class="row">
       <div class="col-md-2">
         <div class="list-group" style="padding:3px 3px">
          <a href="#" class="list-group-item active">
            Hotels   <div id='spinner' class='spinner'></div>

          </a>
          <a href="#" class="list-group-item" value= "SINCQ" onclick="clickHotel(this)">SINCQ</a> 
          <a href="#" class="list-group-item" value= "APPOG" onclick="clickHotel(this)">APPOG</a>
          <a href="#" class="list-group-item" value= "OFDUK" onclick="clickHotel(this)">OFDUK</a>
          <a href="#" class="list-group-item" value= "ATLRS" onclick="clickHotel(this)">ATLRS</a>
          <a href="#" class="list-group-item" value= "ATLFV" onclick="clickHotel(this)">ATLFV</a>

          <a href="#" class="list-group-item" value= "DENAC" onclick="clickHotel(this)">DENAC</a> 
          <a href="#" class="list-group-item" value= "DXBGA" onclick="clickHotel(this)">DXBGA</a> 
          <a href="#" class="list-group-item" value= "STHCT" onclick="clickHotel(this)">STHCT</a>
          <a href="#" class="list-group-item" value= "DXBGA" onclick="clickHotel(this)">DXBGA</a> 
          <a href="#" class="list-group-item" value= "CBGIM" onclick="clickHotel(this)">CBGIM</a> 
          



          <a href="#" class="list-group-item" value= "DXBIC" onclick="clickHotel(this)">DXBIC</a> 
         
          <a href="#" class="list-group-item" value= "ICTUS" onclick="clickHotel(this)">ICTUS</a>
          <a href="#" class="list-group-item" value= "MSNRR" onclick="clickHotel(this)">MSNRR</a>
          <a href="#" class="list-group-item" value= "HOWIN" onclick="clickHotel(this)">HOWIN</a>
          <a href="#" class="list-group-item" value= "LALLD" onclick="clickHotel(this)">LALLD</a>
          <a href="#" class="list-group-item" value= "ACAMX" onclick="clickHotel(this)">ACAMX</a>
          <a href="#" class="list-group-item" value= "ABEDP" onclick="clickHotel(this)">ABEDP</a>
          
          <a href="#" class="list-group-item" value= "ACACC" onclick="clickHotel(this)">ACACC</a>
          <a href="#" class="list-group-item" value= "ATLAA" onclick="clickHotel(this)">ATLAA</a>
          <a href="#" class="list-group-item" value= "ATLBH" onclick="clickHotel(this)">ATLAA</a>

          
 
        </div>
        <div class="list-group" style="padding:3px 3px">
          <a href="#" class="list-group-item active">
            Hotels   <div id='spinner' class='spinner'></div>

          </a>
          <a href="#" class="list-group-item" value= "ATLRS" onclick="clickHotelTPI(this)">ATLRS</a> 
         
          
 
        </div>
        <table class="table">
          
        </table>
        </div>
        <div class="col-md-10">
          
          <div class="row">
               <div class="panel panel-default">
                 <div class="panel-heading">
                  <h3>Response</h3>
                 </div>
                 <div class="panel-body">
                    <strong id="response"></strong>
                 </div>
               </div>
          </div>
        </div>
       </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.16/require.min.js"></script>
    <script>
      requirejs.config({
        paths: {
          axios: '/axios.min'
        }
      });
     var opts = {
      lines: 11, // The number of lines to draw
      length: 15, // The length of each line
      width: 10, // The line thickness
      radius: 30, // The radius of the inner circle
      corners: 1, // Corner roundness (0..1)
      rotate: 0, // The rotation offset
      direction: 1, // 1: clockwise, -1: counterclockwise
      color: '#000', // #rgb or #rrggbb
      speed: 0.6, // Rounds per second
      trail: 60, // Afterglow percentage
      shadow: false, // Whether to render a shadow
      hwaccel: false, // Whether to use hardware acceleration
      className: 'spinner', // The CSS class to assign to the spinner
      zIndex: 2e9, // The z-index (defaults to 2000000000)
      top: 'auto', // Top position relative to parent in px
      left: 'auto' // Left position relative to parent in px
    };
    

    var end = moment().add(2, 'days');
      var start = moment().add(1, 'days');
              $('input[name="daterange"]').val(start.format('YYYY-MM-DD') + ' / ' + end.format('YYYY-MM-DD'));

        function clickHotelTPI(e){
           console.log("10.163.76.45");
          requirejs(['axios'], function (axios) {
          
          var config = {
            headers: {'IHG-ChannelId': 'BKGTL', 
                      'IHG-User':'GROLLAT', 
                      'IHG-RequestorId':'BKGTL',
                      'IHG-ApplicationId':'BKT'}
          };

          var config2 = {
            headers: {'AVAIL_MESSAGE': 'IHG/SYDHA?start_date=2017-09-20&end_date=2017-09-21&rateplan=codes:(IDAVP)&guests=[{"type":10,"occ":2}]&room_nb=1&room_type=codes:(KSTG)&room_type=attributes:(-ADA +ADA)', 
                      'channelId':'SYDHA', 
                      'hotelCodes':'[SYDHA]',
                      'ApplicationId':'HGW',
                      'IHG-ChannelId':'SYDHA',
                      'IHG-Pos':'{"hotelSource":"SYDHA"}',
                      'IHG-RequestorId':'PMSES',
                      'operationName':'AUAVS',
                      'PropertyId':'SYDHA',
                      'requestorId':'PMSES',
                      'TPI_MESSAGE':'AU AV:S/ECHO/SYDHA//20SEP17/01/IDAVP   /01/02/KSTG///P',
                      'Access-Control-Allow-Origin': '*',
                      'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
                      'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE',
                      'Access-Control-Allow-Headers':'Content-Type, X-Your-Extra-Header-Key',
                      'Access-Control-Allow-Credentials':' true',
                      'Access-Control-Expose-Headers':' Authorization',
                      'Content-Type': 'application/x-www-form-urlencoded' 
                    }
          };

          var box = document.getElementById('selector');
          var env = box.options[box.selectedIndex].getAttribute("title");
          console.log("env" + env );
           var spinner_div = $('#spinner').get(0);
    var spinner = null;

    if(spinner == null) {
          spinner = new Spinner(opts).spin(spinner_div);
        } else {
          spinner.spin(spinner_div);
        }
        // 10.22.52.66
        // //10.163.76.45
          axios.post('http://10.163.76.45:8080/AvailabilityTPIService?MessageType=SAI_MSG_IN&PropertyId=SYDHA&MessageText=AU%20%0AAV:S/ECHO/SYDHA//14SEP17/5/IGCOR/01/02////P%0A', config2)
            .then(function (hotel) {
              //console.log(hotel.data.hotel.code);
              //document.getElementById('useravatar').src = user.data.avatar_url;
              document.getElementById('response').innerHTML = generateSuccessHTMLOutput(hotel);//hotel.data.hotel.code;
                spinner.stop(spinner_div);

            })
            .catch(function(error){
                     spinner.stop(spinner_div);

              document.getElementById('response').innerHTML  = generateErrorHTMLOutput(error);
            });


        
      });
        }


        function clickHotel(e){
    
          console.log(e.getAttribute("value"));
          requirejs(['axios'], function (axios) {
          
          var config = {
            headers: {'IHG-ChannelId': 'BKGTL', 
                      'IHG-User':'GROLLAT', 
                      'IHG-RequestorId':'BKGTL',
                      'IHG-ApplicationId':'BKT'}
          };

          var config2 = {
            headers: {'IHG-ChannelId': 'SYSTW', 
                      'IHG-User':'GROLLAT', 
                      'IHG-RequestorId':'SYSTW',
                      'IHG-ApplicationId':'availability',
            'Access-Control-Allow-Origin':'yes'}
          };

          var box = document.getElementById('selector');
          var env = box.options[box.selectedIndex].getAttribute("title");
          console.log("env" + env );
           var spinner_div = $('#spinner').get(0);
    var spinner = null;

    if(spinner == null) {
          spinner = new Spinner(opts).spin(spinner_div);
        } else {
          spinner.spin(spinner_div);
        }
      
          axios.get('http://'+ env +  ':8081/availability/v1/hotels/'+ e.innerText +'?end_date='+ end.format('YYYY-MM-DD') +'&process_modifiers=0&chainCode=IHG&guests=%5b%7b%22type%22:10,%22occ%22:1%7d,%7b%22type%22:7,%22occ%22:0%7d%5d&room_nb=1&includeAlternate=true&rateplan_long_desc=true&room_long_desc=true&start_date='+ start.format('YYYY-MM-DD'), config2)
            .then(function (hotel) {
              //console.log(hotel.data.hotel.code);
              //document.getElementById('useravatar').src = user.data.avatar_url;
              document.getElementById('response').innerHTML = generateSuccessHTMLOutput(hotel);//hotel.data.hotel.code;
                spinner.stop(spinner_div);

            })
            .catch(function(error){
                     spinner.stop(spinner_div);

              document.getElementById('response').innerHTML  = generateErrorHTMLOutput(error);
            });


        
      });
          }   

          function generateSuccessHTMLOutput(response) {
  return  '<h4>Result</h4>' + 
          '<h5>Status:</h5> ' + 
          '<pre>' + response.status + ' ' + response.statusText + '</pre>' +
          '<h5>Headers:</h5>' + 
          '<pre>' + JSON.stringify(response.headers, null, '\t') + '</pre>' + 
          '<h5>Data:</h5>' + 
          '<pre>' + JSON.stringify(response.data, null, '\t') + '</pre>'; 
}

          function generateErrorHTMLOutput(error) {
           
              console.log(error.response);
              
  return  '<h4>Result</h4>' + 
          '<h5>Message:</h5> ' + 
          '<pre>' + error.message + '</pre>' +
          '<h5>Status:</h5> ' + 
          '<pre>' + error.response.status + ' ' + error.response.statusText + '</pre>' +
          '<h5>Headers:</h5>' + 
          '<pre>' + JSON.stringify(error.response.headers, null, '\t') + '</pre>' + 
          '<h5>Data:</h5>' + 
          '<pre>' + JSON.stringify(error.response.data, null, '\t') + '</pre>'; 
}  
    </script>
  </body>
</html>
